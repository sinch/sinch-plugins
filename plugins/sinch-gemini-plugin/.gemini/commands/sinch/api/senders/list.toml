description = "Generate code to fetch Sinch active numbers/senders and handle sender operations"

prompt = """
Work with the Sinch Numbers API to retrieve your active phone numbers/senders.

User Request: {{args}}

Instructions:
1. Parse the user request from arguments.

2. If no arguments or generic request (e.g., "list", "help"):
   Display the quick reference menu:
   ```
   Sinch Numbers API - Active Senders
   
   API Endpoint: GET https://numbers.api.sinch.com/v1/projects/{projectId}/activeNumbers
   
   What would you like to do?
   1. Generate code - Create a function to fetch active senders
   2. Debug issues - Troubleshoot sender retrieval problems
   3. Explain the API - Learn about the endpoint and response structure
   4. Add pagination - Handle large datasets
   5. Freestyle - Describe your own request or question
   ```

3. If user selects option 1 or requests code generation (e.g., "generate", "code", "implement", "1"):
   Provide a complete implementation:
   ```typescript
   interface Numbers {
     phoneNumber: string;
     projectId: string;
     displayName: string;
     regionCode: string;
     type: string;
     capability: string[];
   }
   
   async function loadSenders(projectId: string, authToken: string): Promise<Numbers[]> {
     const response = await fetch(
       `https://numbers.api.sinch.com/v1/projects/$${projectId}/activeNumbers?page_size=100`,
       {
         method: 'GET',
         headers: {
           'Authorization': `Bearer $${authToken}`,
           'Content-Type': 'application/json',
         },
       }
     );
     
     if (!response.ok) {
       throw new Error(`Failed to load senders: $${response.status}`);
     }
     
     const data = await response.json();
     return data.activeNumbers;
   }
   ```
   
   Usage example:
   ```typescript
   const senders = await loadSenders(
     process.env.CONVERSATION_PROJECT_ID,
     authToken
   );
   console.log(`Found $${senders.length} active numbers`);
   senders.forEach(sender => {
     console.log(`$${sender.phoneNumber} ($${sender.regionCode}) - $${sender.capability.join(', ')}`);
   });
   ```

4. If user selects option 2 or asks about debugging (e.g., "debug", "error", "troubleshoot", "2"):
   List common error scenarios and solutions:
   
   **401 Unauthorized**
   - Cause: Invalid or expired auth token
   - Solution: Regenerate your OAuth2 token using valid credentials
   
   **404 Not Found**
   - Cause: Invalid project ID
   - Solution: Verify CONVERSATION_PROJECT_ID in your environment variables
   
   **429 Too Many Requests**
   - Cause: Rate limiting exceeded
   - Solution: Implement exponential backoff and reduce request frequency
   
   **Network Errors**
   - Cause: Connectivity issues
   - Solution: Check network connection and firewall settings
   
   **Missing Configuration**
   - Cause: Environment variables not set
   - Solution: Set CONVERSATION_PROJECT_ID, CONVERSATION_KEY_ID, CONVERSATION_KEY_SECRET

5. If user selects option 3 or asks about API structure (e.g., "explain", "api", "documentation", "3"):
   Explain endpoint details:
   
   **Base URL**: https://numbers.api.sinch.com/v1
   **Endpoint**: /projects/{projectId}/activeNumbers
   **Method**: GET
   **Authentication**: Bearer token (OAuth 2.0)
   
   **Query Parameters**:
   - `page_size` (optional): Number of results per page (default: 20, max: 100)
   - `page_token` (optional): Token for pagination (from nextPageToken in response)
   - `regionCode` (optional): Filter by region code (e.g., "US", "GB")
   - `type` (optional): Filter by number type (e.g., "MOBILE", "LOCAL", "TOLL_FREE")
   
   **Response Structure**:
   ```json
   {
     "activeNumbers": [
       {
         "phoneNumber": "+14155551234",
         "projectId": "project-123",
         "displayName": "My Number",
         "regionCode": "US",
         "type": "MOBILE",
         "capability": ["SMS", "VOICE"],
         "money": {
           "currencyCode": "USD",
           "amount": "1.00"
         }
       }
     ],
     "nextPageToken": "abc123..."
   }
   ```

6. If user selects option 4 or asks about pagination (e.g., "pagination", "all numbers", "4"):
   Provide pagination implementation:
   ```typescript
   async function loadAllSenders(
     projectId: string,
     authToken: string
   ): Promise<Numbers[]> {
     let allNumbers: Numbers[] = [];
     let pageToken: string | undefined;
     
     do {
       const url = new URL(
         `https://numbers.api.sinch.com/v1/projects/$${projectId}/activeNumbers`
       );
       url.searchParams.set('page_size', '100');
       if (pageToken) {
         url.searchParams.set('page_token', pageToken);
       }
       
       const response = await fetch(url.toString(), {
         method: 'GET',
         headers: {
           'Authorization': `Bearer $${authToken}`,
           'Content-Type': 'application/json',
         },
       });
       
       if (!response.ok) {
         throw new Error(`Failed to load senders: $${response.status}`);
       }
       
       const data = await response.json();
       allNumbers = allNumbers.concat(data.activeNumbers || []);
       pageToken = data.nextPageToken;
     } while (pageToken);
     
     return allNumbers;
   }
   ```

7. If user selects option 5 or provides custom request:
   Process the user's specific question about active senders, providing:
   - Relevant code examples
   - API documentation references
   - Best practices
   - Troubleshooting tips

Example usage:
/sinch:senders:list
/sinch:senders:list generate
/sinch:senders:list debug
/sinch:senders:list explain api
/sinch:senders:list how do I filter by region?
/sinch:senders:list show me pagination example

API Reference:
https://developers.sinch.com/docs/numbers/api-reference/numbers/tag/Active-Number/
"""
